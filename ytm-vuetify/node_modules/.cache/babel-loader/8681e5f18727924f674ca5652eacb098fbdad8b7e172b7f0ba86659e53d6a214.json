{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport axios from 'axios';\nimport SvgIcon from '@jamescoyle/vue-icon';\nimport { mdiLogout, mdiMusic } from '@mdi/js';\nexport default {\n  name: 'App',\n  components: {\n    SvgIcon,\n    VAudioPlayer: () => import('@woodydark/vuetify-audio-player')\n  },\n  data: () => ({\n    logoutIconPath: mdiLogout,\n    musicIconPath: mdiMusic\n  }),\n  computed: {\n    user() {\n      return this.$store.state.user.name;\n    },\n    loginFlag() {\n      return this.$store.state.loginFlag;\n    },\n    musicSrc() {\n      if (this.$store.state.curTrack) {\n        return `http://127.0.0.1:3000/stream/${this.$store.state.curTrack.track_id}`;\n      }\n      return null;\n    },\n    trackTitle() {\n      if (this.$store.state.curTrack) {\n        return this.$store.state.curTrack.title;\n      }\n      return null;\n    },\n    trackSubtitle() {\n      if (this.$store.state.curTrack) {\n        return this.$store.state.curTrack.artist.join(', ');\n      }\n      return null;\n    },\n    albumImg() {\n      if (this.$store.state.curTrack) {\n        return `http://127.0.0.1:3000/image/${this.$store.state.curTrack.album_id}.jpg`;\n      }\n      return null;\n    }\n  },\n  provide() {\n    return {\n      setAudioSource: this.setAudioSource\n    };\n  },\n  methods: {\n    setAudioSource(src) {\n      this.$refs.audioPlayer.source = src;\n    },\n    logout() {\n      this.$store.commit('setUser', null);\n      this.$store.commit('setLoginFlag', false);\n      axios.defaults.headers.common.Authorization = null;\n      localStorage.removeItem('token');\n      this.$router.push('/login');\n    },\n    playAlbum(album, order) {\n      // play the track of the corresponding order in the album\n      const albumId = album.pid;\n      console.log('Start to play album:', albumId, 'with order:', order);\n      this.$store.commit('setCurAlbum', album);\n      this.$store.commit('setCurOrder', order);\n      const url = `http://127.0.0.1:3000/getTrackByOrder/?album_id=${albumId}&order=${order}`;\n      axios.get(url).then(response => {\n        this.$store.commit('setCurTrack', response.data);\n        console.log('Got TrackInfo:', this.$store.state.curTrack);\n      }).catch(error => console.error(error));\n    },\n    nextSrc() {\n      console.log('Received request to next song ', 'curOrder:', this.$store.state.curOrder, 'curAlbum:', this.$store.state.curAlbum.name);\n      if (this.$store.state.curOrder != null && this.$store.state.curAlbum) {\n        const newOrder = (this.$store.state.curOrder + 1) % this.$store.state.curAlbum.added;\n        console.log('go to next order:', newOrder);\n        this.playAlbum(this.$store.state.curAlbum, newOrder);\n      }\n    },\n    prevSrc() {\n      console.log('Received request to previous song');\n      if (this.$store.state.curOrder != null && this.$store.state.curAlbum) {\n        // eslint-disable-next-line max-len\n        const newOrder = (this.$store.state.curOrder + this.$store.state.curAlbum.added - 1) % this.$store.state.curAlbum.added;\n        console.log(' go to previous order:', newOrder);\n        this.playAlbum(this.$store.state.curAlbum, newOrder);\n      }\n    }\n  }\n};","map":{"version":3,"names":["axios","SvgIcon","mdiLogout","mdiMusic","name","components","VAudioPlayer","data","logoutIconPath","musicIconPath","computed","user","$store","state","loginFlag","musicSrc","curTrack","track_id","trackTitle","title","trackSubtitle","artist","join","albumImg","album_id","provide","setAudioSource","methods","src","$refs","audioPlayer","source","logout","commit","defaults","headers","common","Authorization","localStorage","removeItem","$router","push","playAlbum","album","order","albumId","pid","console","log","url","get","then","response","catch","error","nextSrc","curOrder","curAlbum","newOrder","added","prevSrc"],"sources":["src/App.vue"],"sourcesContent":["<template>\n  <v-app>\n    <v-app-bar\n      app\n      color=\"primary\"\n      dark\n    >\n      <div class=\"d-flex align-center\">\n        <svg-icon type=\"mdi\" :path=\"musicIconPath\"></svg-icon>\n        <span class=\"mr-2\">Music</span>\n      </div>\n      <v-spacer></v-spacer>\n      <router-link to=\"/login\" v-if=\"!loginFlag\">\n        <v-btn>\n          <span class=\"mr-2\">Login / Sign up</span>\n        </v-btn>\n      </router-link>\n      <span class=\"mr-2\" v-if=\"loginFlag\">Welcome! {{user}}</span>\n      <v-btn @click=\"logout()\" v-if=\"loginFlag\" icon>\n        <svg-icon type=\"mdi\" :path=\"logoutIconPath\"></svg-icon>\n      </v-btn>\n    </v-app-bar>\n\n    <v-main>\n      <router-view/>\n    </v-main>\n\n    <div style=\"position: fixed; bottom: 0; width: 100%;\">\n        <v-audio-player\n            ref=\"audioPlayer\"\n            :src=\"musicSrc\"\n            :track-title=\"trackTitle\"\n            :track-subtitle=\"trackSubtitle\"\n            allow-previous\n            allow-next\n            :compact=\"$vuetify.breakpoint.smAndDown\"\n            :autoplay=\"false\"\n            :album-art=\"albumImg\"\n            @next-audio=\"nextSrc()\"\n            @previous-audio=\"prevSrc()\"\n            prev-track-icon=\"mdi-skip-previous\"\n            next-track-icon=\"mdi-skip-next\"\n            back-forward-icon=\"mdi-rewind-5\"\n            fast-forward-icon=\"fast-forward-5\"\n            play-icon=\"mdi-play\"\n            pause-icon=\"mdi-pause\"\n            mute-volume-icon=\"mdi-volume-off\"\n            low-volume-icon=\"mdi-volume-low\"\n            medium-volume-icon=\"mdi-volume-medium\"\n            high-volume-icon=\"mdi-volume-high\"\n        ></v-audio-player>\n    </div>\n  </v-app>\n</template>\n\n<script>\nimport axios from 'axios';\nimport SvgIcon from '@jamescoyle/vue-icon';\nimport { mdiLogout, mdiMusic } from '@mdi/js';\n\nexport default {\n  name: 'App',\n\n  components: {\n    SvgIcon,\n    VAudioPlayer: () => import('@woodydark/vuetify-audio-player'),\n  },\n\n  data: () => ({\n    logoutIconPath: mdiLogout,\n    musicIconPath: mdiMusic,\n  }),\n\n  computed: {\n    user() {\n      return this.$store.state.user.name;\n    },\n    loginFlag() {\n      return this.$store.state.loginFlag;\n    },\n    musicSrc() {\n      if (this.$store.state.curTrack) {\n        return `http://127.0.0.1:3000/stream/${this.$store.state.curTrack.track_id}`;\n      }\n      return null;\n    },\n    trackTitle() {\n      if (this.$store.state.curTrack) {\n        return this.$store.state.curTrack.title;\n      }\n      return null;\n    },\n    trackSubtitle() {\n      if (this.$store.state.curTrack) {\n        return this.$store.state.curTrack.artist.join(', ');\n      }\n      return null;\n    },\n    albumImg() {\n      if (this.$store.state.curTrack) {\n        return `http://127.0.0.1:3000/image/${this.$store.state.curTrack.album_id}.jpg`;\n      }\n      return null;\n    },\n  },\n\n  provide() {\n    return {\n      setAudioSource: this.setAudioSource,\n    };\n  },\n\n  methods: {\n    setAudioSource(src) {\n      this.$refs.audioPlayer.source = src;\n    },\n    logout() {\n      this.$store.commit('setUser', null);\n      this.$store.commit('setLoginFlag', false);\n      axios.defaults.headers.common.Authorization = null;\n      localStorage.removeItem('token');\n      this.$router.push('/login');\n    },\n    playAlbum(album, order) { // play the track of the corresponding order in the album\n      const albumId = album.pid;\n      console.log('Start to play album:', albumId, 'with order:', order);\n      this.$store.commit('setCurAlbum', album);\n      this.$store.commit('setCurOrder', order);\n      const url = `http://127.0.0.1:3000/getTrackByOrder/?album_id=${albumId}&order=${order}`;\n      axios\n        .get(url)\n        .then((response) => {\n          this.$store.commit('setCurTrack', response.data);\n          console.log('Got TrackInfo:', this.$store.state.curTrack);\n        })\n        .catch((error) => console.error(error));\n    },\n    nextSrc() {\n      console.log('Received request to next song ', 'curOrder:', this.$store.state.curOrder, 'curAlbum:', this.$store.state.curAlbum.name);\n      if (this.$store.state.curOrder != null && this.$store.state.curAlbum) {\n        const newOrder = (this.$store.state.curOrder + 1) % this.$store.state.curAlbum.added;\n        console.log('go to next order:', newOrder);\n        this.playAlbum(this.$store.state.curAlbum, newOrder);\n      }\n    },\n    prevSrc() {\n      console.log('Received request to previous song');\n      if (this.$store.state.curOrder != null && this.$store.state.curAlbum) {\n        // eslint-disable-next-line max-len\n        const newOrder = (this.$store.state.curOrder + this.$store.state.curAlbum.added - 1) % this.$store.state.curAlbum.added;\n        console.log(' go to previous order:', newOrder);\n        this.playAlbum(this.$store.state.curAlbum, newOrder);\n      }\n    },\n  },\n};\n</script>\n"],"mappings":";AAwDA,OAAAA,KAAA;AACA,OAAAC,OAAA;AACA,SAAAC,SAAA,EAAAC,QAAA;AAEA;EACAC,IAAA;EAEAC,UAAA;IACAJ,OAAA;IACAK,YAAA,EAAAA,CAAA;EACA;EAEAC,IAAA,EAAAA,CAAA;IACAC,cAAA,EAAAN,SAAA;IACAO,aAAA,EAAAN;EACA;EAEAO,QAAA;IACAC,KAAA;MACA,YAAAC,MAAA,CAAAC,KAAA,CAAAF,IAAA,CAAAP,IAAA;IACA;IACAU,UAAA;MACA,YAAAF,MAAA,CAAAC,KAAA,CAAAC,SAAA;IACA;IACAC,SAAA;MACA,SAAAH,MAAA,CAAAC,KAAA,CAAAG,QAAA;QACA,4CAAAJ,MAAA,CAAAC,KAAA,CAAAG,QAAA,CAAAC,QAAA;MACA;MACA;IACA;IACAC,WAAA;MACA,SAAAN,MAAA,CAAAC,KAAA,CAAAG,QAAA;QACA,YAAAJ,MAAA,CAAAC,KAAA,CAAAG,QAAA,CAAAG,KAAA;MACA;MACA;IACA;IACAC,cAAA;MACA,SAAAR,MAAA,CAAAC,KAAA,CAAAG,QAAA;QACA,YAAAJ,MAAA,CAAAC,KAAA,CAAAG,QAAA,CAAAK,MAAA,CAAAC,IAAA;MACA;MACA;IACA;IACAC,SAAA;MACA,SAAAX,MAAA,CAAAC,KAAA,CAAAG,QAAA;QACA,2CAAAJ,MAAA,CAAAC,KAAA,CAAAG,QAAA,CAAAQ,QAAA;MACA;MACA;IACA;EACA;EAEAC,QAAA;IACA;MACAC,cAAA,OAAAA;IACA;EACA;EAEAC,OAAA;IACAD,eAAAE,GAAA;MACA,KAAAC,KAAA,CAAAC,WAAA,CAAAC,MAAA,GAAAH,GAAA;IACA;IACAI,OAAA;MACA,KAAApB,MAAA,CAAAqB,MAAA;MACA,KAAArB,MAAA,CAAAqB,MAAA;MACAjC,KAAA,CAAAkC,QAAA,CAAAC,OAAA,CAAAC,MAAA,CAAAC,aAAA;MACAC,YAAA,CAAAC,UAAA;MACA,KAAAC,OAAA,CAAAC,IAAA;IACA;IACAC,UAAAC,KAAA,EAAAC,KAAA;MAAA;MACA,MAAAC,OAAA,GAAAF,KAAA,CAAAG,GAAA;MACAC,OAAA,CAAAC,GAAA,yBAAAH,OAAA,iBAAAD,KAAA;MACA,KAAAhC,MAAA,CAAAqB,MAAA,gBAAAU,KAAA;MACA,KAAA/B,MAAA,CAAAqB,MAAA,gBAAAW,KAAA;MACA,MAAAK,GAAA,sDAAAJ,OAAA,UAAAD,KAAA;MACA5C,KAAA,CACAkD,GAAA,CAAAD,GAAA,EACAE,IAAA,CAAAC,QAAA;QACA,KAAAxC,MAAA,CAAAqB,MAAA,gBAAAmB,QAAA,CAAA7C,IAAA;QACAwC,OAAA,CAAAC,GAAA,wBAAApC,MAAA,CAAAC,KAAA,CAAAG,QAAA;MACA,GACAqC,KAAA,CAAAC,KAAA,IAAAP,OAAA,CAAAO,KAAA,CAAAA,KAAA;IACA;IACAC,QAAA;MACAR,OAAA,CAAAC,GAAA,qDAAApC,MAAA,CAAAC,KAAA,CAAA2C,QAAA,oBAAA5C,MAAA,CAAAC,KAAA,CAAA4C,QAAA,CAAArD,IAAA;MACA,SAAAQ,MAAA,CAAAC,KAAA,CAAA2C,QAAA,iBAAA5C,MAAA,CAAAC,KAAA,CAAA4C,QAAA;QACA,MAAAC,QAAA,SAAA9C,MAAA,CAAAC,KAAA,CAAA2C,QAAA,aAAA5C,MAAA,CAAAC,KAAA,CAAA4C,QAAA,CAAAE,KAAA;QACAZ,OAAA,CAAAC,GAAA,sBAAAU,QAAA;QACA,KAAAhB,SAAA,MAAA9B,MAAA,CAAAC,KAAA,CAAA4C,QAAA,EAAAC,QAAA;MACA;IACA;IACAE,QAAA;MACAb,OAAA,CAAAC,GAAA;MACA,SAAApC,MAAA,CAAAC,KAAA,CAAA2C,QAAA,iBAAA5C,MAAA,CAAAC,KAAA,CAAA4C,QAAA;QACA;QACA,MAAAC,QAAA,SAAA9C,MAAA,CAAAC,KAAA,CAAA2C,QAAA,QAAA5C,MAAA,CAAAC,KAAA,CAAA4C,QAAA,CAAAE,KAAA,aAAA/C,MAAA,CAAAC,KAAA,CAAA4C,QAAA,CAAAE,KAAA;QACAZ,OAAA,CAAAC,GAAA,2BAAAU,QAAA;QACA,KAAAhB,SAAA,MAAA9B,MAAA,CAAAC,KAAA,CAAA4C,QAAA,EAAAC,QAAA;MACA;IACA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}