{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport axios from 'axios';\nimport SvgIcon from '@jamescoyle/vue-icon';\nimport { mdiArrowLeft } from '@mdi/js';\nexport default {\n  name: 'PlaylistView',\n  components: {\n    SvgIcon\n  },\n  props: ['id', 'playlistInfo'],\n  data() {\n    return {\n      snackbar: false,\n      snackbarMsg: 'this is sanckbar message',\n      backIconPath: mdiArrowLeft,\n      tracks: [],\n      userPlaylists: [],\n      ifLiked: false,\n      ifTrackLiked: {}\n    };\n  },\n  methods: {\n    isInUserLibrary() {\n      if (this.$store.state.user) {\n        axios.get(`http://127.0.0.1:3000/user/${this.$store.state.user.uid}`, {\n          headers: {\n            Authorization: `Bearer ${localStorage.getItem('token')}`\n          }\n        }).then(response => {\n          this.userAlbums = response.data.albums;\n          console.log('Fetch user albums:', this.userAlbums);\n          this.userPlaylists = response.data.playlists;\n          console.log('Fetch user playlists', this.userPlaylists);\n          for (let i = 0; i < this.userPlaylists.length; i += 1) {\n            if (this.userPlaylists[i].pid === this.id) {\n              this.ifLiked = true;\n              break;\n            }\n          }\n        }).catch(error => console.error(error));\n      }\n    },\n    likePlaylist() {\n      if (this.ifLiked) {\n        axios.delete(`http://127.0.0.1:3000/playlist/?user_id=${this.$store.state.user.uid}&pid=${this.id}`, {\n          headers: {\n            Authorization: `Bearer ${localStorage.getItem('token')}`\n          }\n        }).then(response => {\n          if (response.status === 200) {\n            console.log(response.data.msg);\n            this.ifLiked = false;\n            this.snackbarMsg = response.data.msg;\n            this.snackbar = true;\n          }\n        }).catch(error => console.error(error));\n      } else {\n        axios.put(`http://127.0.0.1:3000/playlist/?user_id=${this.$store.state.user.uid}&pid=${this.id}`, {\n          headers: {\n            Authorization: `Bearer ${localStorage.getItem('token')}`\n          }\n        }).then(response => {\n          if (response.status === 200) {\n            console.log(response.data.msg);\n            this.ifLiked = true;\n            this.snackbarMsg = response.data.msg;\n            this.snackbar = true;\n          }\n        }).catch(error => console.error(error));\n      }\n    },\n    likeTrack(tid) {\n      if (this.ifTrackLiked[tid]) {\n        // track in the playlist\n        axios.delete(`http://127.0.0.1:3000/track/?user_id=${this.$store.state.user.uid}&pid=${this.id}&tid=${tid}`, {\n          headers: {\n            Authorization: `Bearer ${localStorage.getItem('token')}`\n          }\n        }).then(response => {\n          if (response.status === 200 && response.data.status === 0) {\n            this.snackbarMsg = response.data.msg;\n            this.snackbar = true;\n            // this.ifTrackLiked[index] = false;\n            this.ifTrackLiked = {\n              ...this.ifTrackLiked,\n              [tid]: false\n            };\n            console.log(response.data.msg, this.ifTrackLiked);\n          }\n        }).catch(error => console.error(error));\n      } else {\n        // track not in the playlist\n        axios.put(`http://127.0.0.1:3000/track/?user_id=${this.$store.state.user.uid}&pid=${this.id}&tid=${tid}`, {\n          headers: {\n            Authorization: `Bearer ${localStorage.getItem('token')}`\n          }\n        }).then(response => {\n          if (response.status === 200 && response.data.status === 0) {\n            this.snackbarMsg = response.data.msg;\n            this.snackbar = true;\n            // this.ifTrackLiked[index] = true;\n            this.ifTrackLiked = {\n              ...this.ifTrackLiked,\n              [tid]: true\n            };\n            console.log(response.data.msg, this.ifTrackLiked);\n          }\n        }).catch(error => console.error(error));\n      }\n    },\n    fetchTracks() {\n      axios.get(`http://127.0.0.1:3000/getTracksByOrder/${this.id}`).then(response => {\n        this.tracks = response.data;\n        console.log('fetch Tracks:', this.tracks);\n        for (let i = 0; i < this.tracks.length; i += 1) {\n          // this.ifTrackLiked.push(true);\n          this.ifTrackLiked = {\n            ...this.ifTrackLiked,\n            [this.tracks[i].track_id]: true\n          };\n        }\n        console.log('ifTrackLiked object:', this.ifTrackLiked);\n      }).catch(error => console.error(error));\n    },\n    getDuration(time) {\n      let seconds = Math.round(time);\n      const minutes = Math.floor(seconds / 60);\n      seconds %= 60;\n      const paddedSeconds = seconds.toString().padStart(2, '0');\n      return `${minutes}:${paddedSeconds}`;\n    },\n    playAlbum(album, order) {\n      // play the track of the corresponding order in the album\n      const albumId = album.pid;\n      console.log('Start to play album:', albumId, 'with order:', order);\n      this.$store.commit('setCurAlbum', album);\n      this.$store.commit('setCurOrder', order);\n      const url = `http://127.0.0.1:3000/getTrackByOrder/?album_id=${albumId}&order=${order}`;\n      axios.get(url).then(response => {\n        this.$store.commit('setCurTrack', response.data);\n        console.log('Got TrackInfo:', this.$store.state.curTrack);\n      }).catch(error => console.error(error));\n    },\n    goBack() {\n      this.$router.push('/explore');\n    }\n  },\n  mounted() {\n    this.isInUserLibrary();\n    this.fetchTracks();\n  }\n};","map":{"version":3,"names":["axios","SvgIcon","mdiArrowLeft","name","components","props","data","snackbar","snackbarMsg","backIconPath","tracks","userPlaylists","ifLiked","ifTrackLiked","methods","isInUserLibrary","$store","state","user","get","uid","headers","Authorization","localStorage","getItem","then","response","userAlbums","albums","console","log","playlists","i","length","pid","id","catch","error","likePlaylist","delete","status","msg","put","likeTrack","tid","fetchTracks","track_id","getDuration","time","seconds","Math","round","minutes","floor","paddedSeconds","toString","padStart","playAlbum","album","order","albumId","commit","url","curTrack","goBack","$router","push","mounted"],"sources":["src/views/PlaylistView.vue"],"sourcesContent":["<template>\n  <v-card\n    color=\"grey lighten-4\"\n    flat\n    tile\n  >\n    <v-toolbar\n    >\n      <v-btn icon style=\"margin-right:20px;\" @click=\"goBack\">\n        <svg-icon type=\"mdi\" :path=\"backIconPath\"></svg-icon>\n      </v-btn>\n      <v-toolbar-title style=\"margin-left:20px;\">{{playlistInfo.name}}</v-toolbar-title>\n      <v-card-text style=\"width: auto;\">{{tracks.length}} songs</v-card-text>\n      <v-spacer></v-spacer>\n\n      <v-btn @click=\"likePlaylist()\" icon>\n        <v-icon v-if=\"!ifLiked\">mdi-heart-outline</v-icon>\n        <v-icon v-if=\"ifLiked\">mdi-heart</v-icon>\n      </v-btn>\n\n    </v-toolbar>\n\n    <v-simple-table>\n    <template v-slot:default>\n      <thead>\n        <tr>\n          <th class=\"text-center\">\n            #\n          </th>\n          <th class=\"text-center\">\n            Name\n          </th>\n          <th class=\"text-center\">\n            Artists\n          </th>\n          <th class=\"text-center\">\n            Album\n          </th>\n          <th class=\"text-center\">\n            Duration\n          </th>\n          <th class=\"text-center\">\n            Liked\n          </th>\n          <th class=\"text-center\">\n            Play\n          </th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr\n          v-for=\"(track, index) in tracks\"\n          :key=\"track.track_id\"\n        >\n          <td class=\"text-center\">{{ index+1 }}</td>\n          <td class=\"text-center\">{{ track.title }}</td>\n          <td class=\"text-center\">{{ track.artist.join(', ') }}</td>\n          <td class=\"text-center\">{{ track.album }}</td>\n          <td class=\"text-center\">{{ getDuration(track.length) }}</td>\n          <td class=\"text-center\">\n            <v-btn @click.stop=\"likeTrack(track.track_id)\" icon>\n              <v-icon v-if=\"!ifTrackLiked[track.track_id]\">mdi-heart-outline</v-icon>\n              <v-icon v-else>mdi-heart</v-icon>\n            </v-btn>\n          </td>\n          <td class=\"text-center\">\n            <v-btn @click=\"playAlbum(playlistInfo, index)\" icon>\n              <v-icon>mdi-play</v-icon>\n            </v-btn>\n          </td>\n        </tr>\n      </tbody>\n    </template>\n  </v-simple-table>\n\n  <v-snackbar\n      v-model=\"snackbar\"\n      :timeout=2000\n  >\n      {{ snackbarMsg }}\n\n      <template v-slot:action=\"{ attrs }\">\n        <v-btn\n          color=\"blue\"\n          text\n          v-bind=\"attrs\"\n          @click=\"snackbar = false\"\n        >\n          Close\n        </v-btn>\n      </template>\n  </v-snackbar>\n\n  </v-card>\n</template>\n\n<script>\nimport axios from 'axios';\nimport SvgIcon from '@jamescoyle/vue-icon';\nimport { mdiArrowLeft } from '@mdi/js';\n\nexport default {\n  name: 'PlaylistView',\n\n  components: {\n    SvgIcon,\n  },\n\n  props: ['id', 'playlistInfo'],\n\n  data() {\n    return {\n      snackbar: false,\n      snackbarMsg: 'this is sanckbar message',\n      backIconPath: mdiArrowLeft,\n      tracks: [],\n      userPlaylists: [],\n      ifLiked: false,\n      ifTrackLiked: {},\n    };\n  },\n  methods: {\n    isInUserLibrary() {\n      if (this.$store.state.user) {\n        axios\n          .get(`http://127.0.0.1:3000/user/${this.$store.state.user.uid}`, {\n            headers: {\n              Authorization: `Bearer ${localStorage.getItem('token')}`,\n            },\n          })\n          .then((response) => {\n            this.userAlbums = response.data.albums;\n            console.log('Fetch user albums:', this.userAlbums);\n            this.userPlaylists = response.data.playlists;\n            console.log('Fetch user playlists', this.userPlaylists);\n            for (let i = 0; i < this.userPlaylists.length; i += 1) {\n              if (this.userPlaylists[i].pid === this.id) {\n                this.ifLiked = true;\n                break;\n              }\n            }\n          })\n          .catch((error) => console.error(error));\n      }\n    },\n    likePlaylist() {\n      if (this.ifLiked) {\n        axios\n          .delete(`http://127.0.0.1:3000/playlist/?user_id=${this.$store.state.user.uid}&pid=${this.id}`, {\n            headers: {\n              Authorization: `Bearer ${localStorage.getItem('token')}`,\n            },\n          })\n          .then((response) => {\n            if (response.status === 200) {\n              console.log(response.data.msg);\n              this.ifLiked = false;\n              this.snackbarMsg = response.data.msg;\n              this.snackbar = true;\n            }\n          })\n          .catch((error) => console.error(error));\n      } else {\n        axios\n          .put(`http://127.0.0.1:3000/playlist/?user_id=${this.$store.state.user.uid}&pid=${this.id}`, {\n            headers: {\n              Authorization: `Bearer ${localStorage.getItem('token')}`,\n            },\n          })\n          .then((response) => {\n            if (response.status === 200) {\n              console.log(response.data.msg);\n              this.ifLiked = true;\n              this.snackbarMsg = response.data.msg;\n              this.snackbar = true;\n            }\n          })\n          .catch((error) => console.error(error));\n      }\n    },\n    likeTrack(tid) {\n      if (this.ifTrackLiked[tid]) { // track in the playlist\n        axios\n          .delete(`http://127.0.0.1:3000/track/?user_id=${this.$store.state.user.uid}&pid=${this.id}&tid=${tid}`, {\n            headers: {\n              Authorization: `Bearer ${localStorage.getItem('token')}`,\n            },\n          })\n          .then((response) => {\n            if (response.status === 200 && response.data.status === 0) {\n              this.snackbarMsg = response.data.msg;\n              this.snackbar = true;\n              // this.ifTrackLiked[index] = false;\n              this.ifTrackLiked = { ...this.ifTrackLiked, [tid]: false };\n              console.log(response.data.msg, this.ifTrackLiked);\n            }\n          })\n          .catch((error) => console.error(error));\n      } else { // track not in the playlist\n        axios\n          .put(`http://127.0.0.1:3000/track/?user_id=${this.$store.state.user.uid}&pid=${this.id}&tid=${tid}`, {\n            headers: {\n              Authorization: `Bearer ${localStorage.getItem('token')}`,\n            },\n          })\n          .then((response) => {\n            if (response.status === 200 && response.data.status === 0) {\n              this.snackbarMsg = response.data.msg;\n              this.snackbar = true;\n              // this.ifTrackLiked[index] = true;\n              this.ifTrackLiked = { ...this.ifTrackLiked, [tid]: true };\n              console.log(response.data.msg, this.ifTrackLiked);\n            }\n          })\n          .catch((error) => console.error(error));\n      }\n    },\n    fetchTracks() {\n      axios\n        .get(`http://127.0.0.1:3000/getTracksByOrder/${this.id}`)\n        .then((response) => {\n          this.tracks = response.data;\n          console.log('fetch Tracks:', this.tracks);\n          for (let i = 0; i < this.tracks.length; i += 1) {\n            // this.ifTrackLiked.push(true);\n            this.ifTrackLiked = { ...this.ifTrackLiked, [this.tracks[i].track_id]: true };\n          }\n          console.log('ifTrackLiked object:', this.ifTrackLiked);\n        })\n        .catch((error) => console.error(error));\n    },\n    getDuration(time) {\n      let seconds = Math.round(time);\n      const minutes = Math.floor(seconds / 60);\n      seconds %= 60;\n      const paddedSeconds = seconds.toString().padStart(2, '0');\n      return `${minutes}:${paddedSeconds}`;\n    },\n    playAlbum(album, order) { // play the track of the corresponding order in the album\n      const albumId = album.pid;\n      console.log('Start to play album:', albumId, 'with order:', order);\n      this.$store.commit('setCurAlbum', album);\n      this.$store.commit('setCurOrder', order);\n      const url = `http://127.0.0.1:3000/getTrackByOrder/?album_id=${albumId}&order=${order}`;\n      axios\n        .get(url)\n        .then((response) => {\n          this.$store.commit('setCurTrack', response.data);\n          console.log('Got TrackInfo:', this.$store.state.curTrack);\n        })\n        .catch((error) => console.error(error));\n    },\n    goBack() {\n      this.$router.push('/explore');\n    },\n  },\n  mounted() {\n    this.isInUserLibrary();\n    this.fetchTracks();\n  },\n};\n</script>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}